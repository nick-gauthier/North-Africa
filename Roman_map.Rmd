---
title: "Mapping Roman North Africa"
author: "Nick"
date: "6/8/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
library(tidyverse)
library(stringr)
library(pleiades)
library(raster)
library(rasterVis)
```

Import SRTM basemap
```{r}
bbox <- extent(-10, 20, 28, 38)
srtm <- raster('Data/SRTM_NE_250m_TIF/SRTM_NE_250m.tif') %>%
  crop(bbox)

gplot(srtm) +
  geom_raster(aes(fill = value)) +
  coord_fixed()

```


```{r}
places <- pl_search_places() %>%
  filter(locationPrecision == 'precise') %>%
  select(title, type = featureTypes, description, 
         lon = reprLong, lat = reprLat, 
         periods = timePeriods, minDate, maxDate, id, tags) %>%
  filter(between(lat, 28, 38) & between(lon, -10, 20)) %>%
  collect  %>%
  filter(str_detect(periods, 'R')) %>%
  print


villas <- filter(places, str_detect(type, 'villa'))
mines <- filter(places, str_detect(type, 'mine'))
settlements <- filter(places, str_detect(type,'settlement'))
springs <- filter(places, str_detect(type, 'spring'))
estates <- filter(places, str_detect(type, 'estate'))
oases <- filter(places, str_detect(type, 'oasis'))

major <- settlements %>% filter(str_detect(tags, 'major=1'))

gplot(srtm) +
  geom_raster(aes(fill = value)) +
  geom_point(data = major, aes(x = lon, y = lat)) +
  coord_fixed()

```


```{r}
roads <- readOGR('Roman Road Network (version 2008)/roads/') %>%
  spTransform(CRS('+proj=longlat')) %>%
  crop(extent(-10, 20, 30, 38))

plot(roads)
```





